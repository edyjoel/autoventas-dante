---

---

<header class="site-header">
  <div class="container header-inner">
    <div class="logo">
      <a class="logo-link" href="/">Autoventas Dante</a>
    </div>
    <button
      class="hamburger"
      type="button"
      aria-label="Menú"
      aria-expanded="false"
      aria-controls="primary-nav"
    >
      <span></span>
      <span></span>
      <span></span>
    </button>
    <nav id="primary-nav" class="site-nav" aria-label="Navegación principal">
      <ul class="site-nav-list">
        <li class="site-nav-item">
          <a class="site-nav-link" href="/#hero" data-target="#hero">Inicio</a>
        </li>
        <li class="site-nav-item">
          <a class="site-nav-link" href="/#modelos" data-target="#modelos"
            >Modelos</a
          >
        </li>
        <li class="site-nav-item">
          <a class="site-nav-link" href="/#contacto" data-target="#contacto"
            >Contacto</a
          >
        </li>
      </ul>
    </nav>
  </div>
</header>

<script>
  const HEADER_BOUND_ATTR = "data-header-page-load-bound";
  let cleanupHeader = () => {};

  const initHeader = () => {
    cleanupHeader();

    const hamburger = document.querySelector(".hamburger");
    const nav = document.querySelector(".site-nav");
    const header = document.querySelector(".site-header");

    if (!(header instanceof HTMLElement)) {
      cleanupHeader = () => {};
      return;
    }

    const toggleHeaderShadow = () => {
      header.classList.toggle("scrolled", window.scrollY > 0);
    };

    const closeMobileMenu = () => {
      if (hamburger instanceof HTMLButtonElement) {
        hamburger.setAttribute("aria-expanded", "false");
        hamburger.classList.remove("active");
      }

      if (nav instanceof HTMLElement) {
        nav.classList.remove("active");
      }
    };

    const handleHamburgerClick = () => {
      if (!(hamburger instanceof HTMLButtonElement)) return;
      const isExpanded = hamburger.getAttribute("aria-expanded") === "true";
      hamburger.setAttribute("aria-expanded", String(!isExpanded));
      hamburger.classList.toggle("active");
      nav?.classList.toggle("active");
    };

    const navLinks = Array.from(
      document.querySelectorAll(".site-nav a[data-target]"),
    );

    const sections = navLinks
      .map((link) =>
        document.querySelector(link.getAttribute("data-target") || ""),
      )
      .filter((section) => section instanceof HTMLElement);

    const updateActiveLink = (targetId = "") => {
      const matchingLink = navLinks.find(
        (link) => link.getAttribute("data-target") === targetId,
      );

      navLinks.forEach((link) => {
        const isActive = link === matchingLink;
        link.classList.toggle("active", isActive);
        if (isActive) {
          link.setAttribute("aria-current", "location");
        } else {
          link.removeAttribute("aria-current");
        }
      });
    };

    const SCROLL_OFFSET = 100;

    const handleScrollSpy = () => {
      if (!sections.length) return;

      const scrollPosition = window.scrollY + SCROLL_OFFSET;
      let currentSection = sections[0];

      sections.forEach((section) => {
        if (section.offsetTop - SCROLL_OFFSET <= scrollPosition) {
          currentSection = section;
        }
      });

      if (!currentSection) return;
      updateActiveLink(`#${currentSection.id}`);
    };

    const handleLinkClick = () => {
      closeMobileMenu();
    };

    toggleHeaderShadow();
    window.addEventListener("scroll", toggleHeaderShadow, { passive: true });

    if (hamburger instanceof HTMLButtonElement) {
      hamburger.addEventListener("click", handleHamburgerClick);
    }

    navLinks.forEach((link) => {
      link.addEventListener("click", handleLinkClick);
    });

    if (sections.length) {
      handleScrollSpy();
      window.addEventListener("scroll", handleScrollSpy, { passive: true });
      window.addEventListener("resize", handleScrollSpy);
    } else {
      updateActiveLink(window.location.hash || "#hero");
    }

    cleanupHeader = () => {
      window.removeEventListener("scroll", toggleHeaderShadow);
      window.removeEventListener("scroll", handleScrollSpy);
      window.removeEventListener("resize", handleScrollSpy);

      if (hamburger instanceof HTMLButtonElement) {
        hamburger.removeEventListener("click", handleHamburgerClick);
      }

      navLinks.forEach((link) => {
        link.removeEventListener("click", handleLinkClick);
      });
    };
  };

  if (!document.documentElement.hasAttribute(HEADER_BOUND_ATTR)) {
    document.addEventListener("astro:page-load", initHeader);
    document.documentElement.setAttribute(HEADER_BOUND_ATTR, "true");
  }

  initHeader();
</script>

<style>
  .site-header {
    background-color: var(--color-bg-light);
    color: var(--color-text-primary);
    padding: 1rem 0;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    z-index: 1100;
    box-shadow: none;
    transition: box-shadow 0.3s ease;
  }

  .site-header.scrolled {
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08);
  }

  .header-inner {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 2rem;
  }

  .logo-link {
    font-size: 1.25rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.18em;
    color: var(--color-primary);
    font-family: var(--font-heading);
    display: inline-flex;
    align-items: center;
  }

  .hamburger {
    display: none;
    flex-direction: column;
    gap: 5px;
    background: none;
    border: none;
    cursor: pointer;
    padding: 0.5rem;
    z-index: 1001;
  }

  .hamburger span {
    display: block;
    width: 25px;
    height: 3px;
    background-color: var(--color-text-primary);
    transition: all 0.3s ease;
    border-radius: 2px;
  }

  .hamburger.active span:nth-child(1) {
    transform: rotate(45deg) translate(7px, 7px);
  }

  .hamburger.active span:nth-child(2) {
    opacity: 0;
  }

  .hamburger.active span:nth-child(3) {
    transform: rotate(-45deg) translate(7px, -7px);
  }

  .site-nav-list {
    list-style: none;
    margin: 0;
    padding: 0;
    display: flex;
    gap: 2rem;
  }

  .site-nav-link {
    color: inherit;
  }

  .site-nav-link.active {
    color: var(--color-primary);
  }

  @media (max-width: 768px) {
    .hamburger {
      display: flex;
    }

    .site-nav {
      position: fixed;
      top: 0;
      right: -100%;
      width: 70%;
      max-width: 300px;
      height: 100vh;
      background-color: var(--color-bg-light);
      box-shadow: -2px 0 10px rgba(0, 0, 0, 0.1);
      transition: right 0.3s ease;
      z-index: 1000;
      padding-top: calc(var(--header-height) + var(--space-2));
    }

    .site-nav.active {
      right: 0;
    }

    .site-nav-list {
      flex-direction: column;
      gap: 0;
      padding: 1rem;
    }

    .site-nav-item {
      border-bottom: 1px solid var(--color-border);
    }

    .site-nav-link {
      display: block;
      padding: 1rem;
    }
  }
</style>
